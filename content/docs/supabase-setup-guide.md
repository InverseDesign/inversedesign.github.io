---
title: "Supabase é¡¹ç›®è®¾ç½®è¯¦ç»†æŒ‡å—"
date: 2023-06-23
description: "è¯¦ç»†çš„ Supabase é¡¹ç›®åˆ›å»ºå’Œé…ç½®æŒ‡å—ï¼ŒåŒ…å«æˆªå›¾å’Œæ­¥éª¤è¯´æ˜"
tags:
  - Supabase
  - è®¾ç½®æŒ‡å—
  - é…ç½®æ•™ç¨‹
  - æ•°æ®åº“
categories:
  - æ•™ç¨‹
---

{{< callout type="info" emoji="ğŸ”§" >}}
**æœ¬æŒ‡å—å°†è¯¦ç»†è¯´æ˜å¦‚ä½•åˆ›å»º Supabase é¡¹ç›®å¹¶è·å–å¿…è¦çš„é…ç½®ä¿¡æ¯ã€‚**
{{< /callout >}}

## æ­¥éª¤ 1: åˆ›å»º Supabase è´¦æˆ·

### 1.1 è®¿é—® Supabase å®˜ç½‘
1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® [supabase.com](https://supabase.com)
2. ç‚¹å‡»å³ä¸Šè§’çš„ "Start your project" æŒ‰é’®

### 1.2 é€‰æ‹©ç™»å½•æ–¹å¼
- **æ¨èä½¿ç”¨ GitHub ç™»å½•**ï¼ˆæœ€ç®€å•ï¼‰
- ä¹Ÿå¯ä»¥ä½¿ç”¨ Google è´¦æˆ·ç™»å½•
- æˆ–è€…ä½¿ç”¨é‚®ç®±æ³¨å†Œæ–°è´¦æˆ·

### 1.3 æˆæƒè®¿é—®
- å¦‚æœä½¿ç”¨ GitHub ç™»å½•ï¼Œéœ€è¦æˆæƒ Supabase è®¿é—®æ‚¨çš„ GitHub è´¦æˆ·
- ç‚¹å‡» "Authorize Supabase" æŒ‰é’®

## æ­¥éª¤ 2: åˆ›å»ºæ–°é¡¹ç›®

### 2.1 è¿›å…¥é¡¹ç›®åˆ›å»ºé¡µé¢
ç™»å½•åï¼Œæ‚¨ä¼šçœ‹åˆ° Supabase æ§åˆ¶å°ï¼š
1. ç‚¹å‡» "New Project" æŒ‰é’®
2. æˆ–è€…ç‚¹å‡» "Create a new project" é“¾æ¥

### 2.2 é€‰æ‹©ç»„ç»‡
- å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œä¼šæç¤ºåˆ›å»ºç»„ç»‡
- è¾“å…¥ç»„ç»‡åç§°ï¼ˆå¦‚ï¼š`My Organization`ï¼‰
- ç‚¹å‡» "Create organization"

### 2.3 å¡«å†™é¡¹ç›®ä¿¡æ¯
åœ¨é¡¹ç›®åˆ›å»ºè¡¨å•ä¸­å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

```
é¡¹ç›®åç§°: hugo-comments-demo
æ•°æ®åº“å¯†ç : [è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ï¼Œè‡³å°‘8ä½]
åœ°åŒº: [é€‰æ‹©ç¦»æ‚¨æœ€è¿‘çš„åœ°åŒº]
å®šä»·è®¡åˆ’: Free tier (å…è´¹è®¡åˆ’)
```

**é‡è¦æç¤ºï¼š**
- é¡¹ç›®åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„
- æ•°æ®åº“å¯†ç è¦è®°ä½ï¼Œåç»­å¯èƒ½éœ€è¦ç”¨åˆ°
- åœ°åŒºé€‰æ‹©ä¼šå½±å“è®¿é—®é€Ÿåº¦

### 2.4 åˆ›å»ºé¡¹ç›®
ç‚¹å‡» "Create new project" æŒ‰é’®ï¼Œç­‰å¾…é¡¹ç›®åˆ›å»ºå®Œæˆï¼ˆé€šå¸¸éœ€è¦ 1-2 åˆ†é’Ÿï¼‰ã€‚

## æ­¥éª¤ 3: è·å–é¡¹ç›®é…ç½®ä¿¡æ¯

### 3.1 è¿›å…¥é¡¹ç›®è®¾ç½®
é¡¹ç›®åˆ›å»ºå®Œæˆåï¼š
1. åœ¨é¡¹ç›®åˆ—è¡¨ä¸­ç‚¹å‡»æ‚¨åˆšåˆ›å»ºçš„é¡¹ç›®
2. è¿›å…¥é¡¹ç›®æ§åˆ¶å°

### 3.2 æ‰¾åˆ° API è®¾ç½®
åœ¨å·¦ä¾§å¯¼èˆªæ ä¸­ï¼š
1. ç‚¹å‡» "Settings"ï¼ˆè®¾ç½®ï¼‰
2. åœ¨è®¾ç½®èœå•ä¸­ç‚¹å‡» "API"

### 3.3 å¤åˆ¶é…ç½®ä¿¡æ¯
åœ¨ API è®¾ç½®é¡µé¢ï¼Œæ‚¨ä¼šçœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

#### Project URL
```
https://[your-project-id].supabase.co
```
- è¿™æ˜¯æ‚¨çš„é¡¹ç›® URL
- æ ¼å¼ç±»ä¼¼ï¼š`https://dsrzlugtzanbzwzagakd.supabase.co`

#### API Keys
åœ¨ "Project API keys" éƒ¨åˆ†ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸¤ä¸ªå¯†é’¥ï¼š

**anon public** (æ¨èç”¨äºå‰ç«¯)
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
- è¿™æ˜¯å…¬å¼€çš„åŒ¿åå¯†é’¥
- å¯ä»¥å®‰å…¨åœ°åœ¨å‰ç«¯ä»£ç ä¸­ä½¿ç”¨
- ç”¨äºå®¢æˆ·ç«¯è®¿é—®

**service_role secret** (ä»…ç”¨äºåç«¯)
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
- è¿™æ˜¯æœåŠ¡ç«¯å¯†é’¥
- å…·æœ‰å®Œæ•´çš„ç®¡ç†æƒé™
- åªèƒ½åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ï¼Œä¸è¦æš´éœ²ç»™å‰ç«¯

### 3.4 å¤åˆ¶é…ç½®ä¿¡æ¯
å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯åˆ°å®‰å…¨çš„åœ°æ–¹ï¼š
- **Project URL**
- **anon public** å¯†é’¥

## æ­¥éª¤ 4: é…ç½®ç¯å¢ƒå˜é‡

### 4.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# .env
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=your-anon-public-key
```

### 4.2 æ›´æ–° Hugo é…ç½®
ç¼–è¾‘ `hugo.yaml` æ–‡ä»¶ï¼š

```yaml
params:
  supabase:
    url: "https://your-project-id.supabase.co"
    anonKey: "your-anon-public-key"
```

## æ­¥éª¤ 5: åˆå§‹åŒ–æ•°æ®åº“

### 5.1 è¿›å…¥ SQL ç¼–è¾‘å™¨
åœ¨ Supabase æ§åˆ¶å°ä¸­ï¼š
1. ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„ "SQL Editor"
2. ç‚¹å‡» "New query" åˆ›å»ºæ–°æŸ¥è¯¢

### 5.2 è¿è¡Œåˆå§‹åŒ–è„šæœ¬
å¤åˆ¶ä»¥ä¸‹ SQL è„šæœ¬å¹¶ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ï¼š

```sql
-- åˆ›å»ºè¯„è®ºè¡¨
CREATE TABLE IF NOT EXISTS comments (
  id SERIAL PRIMARY KEY,
  post_id TEXT NOT NULL,
  post_title TEXT NOT NULL,
  author TEXT NOT NULL,
  email TEXT NOT NULL,
  content TEXT NOT NULL,
  user_agent TEXT,
  ip_address TEXT,
  status TEXT DEFAULT 'approved' CHECK (status IN ('pending', 'approved', 'spam', 'deleted')),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- åˆ›å»ºè®¿é—®æ—¥å¿—è¡¨
CREATE TABLE IF NOT EXISTS access_logs (
  id SERIAL PRIMARY KEY,
  action TEXT NOT NULL,
  post_id TEXT,
  ip_address TEXT,
  user_agent TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_comments_post_id ON comments(post_id);
CREATE INDEX IF NOT EXISTS idx_comments_status ON comments(status);
CREATE INDEX IF NOT EXISTS idx_comments_created_at ON comments(created_at);

-- å¯ç”¨è¡Œçº§å®‰å…¨
ALTER TABLE comments ENABLE ROW LEVEL SECURITY;
ALTER TABLE access_logs ENABLE ROW LEVEL SECURITY;

-- åˆ›å»ºç­–ç•¥
CREATE POLICY "Allow public read approved comments" ON comments
  FOR SELECT USING (status = 'approved');

CREATE POLICY "Allow public insert comments" ON comments
  FOR INSERT WITH CHECK (true);

CREATE POLICY "Allow public insert access logs" ON access_logs
  FOR INSERT WITH CHECK (true);
```

### 5.3 æ‰§è¡Œè„šæœ¬
ç‚¹å‡» "Run" æŒ‰é’®æ‰§è¡Œè„šæœ¬ï¼Œç­‰å¾…æ‰§è¡Œå®Œæˆã€‚

## æ­¥éª¤ 6: éªŒè¯é…ç½®

### 6.1 æ£€æŸ¥è¡¨åˆ›å»º
åœ¨å·¦ä¾§å¯¼èˆªæ ä¸­ï¼š
1. ç‚¹å‡» "Table Editor"
2. ç¡®è®¤ `comments` å’Œ `access_logs` è¡¨å·²åˆ›å»º

### 6.2 æµ‹è¯•è¿æ¥
å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æµ‹è¯•è¿æ¥ï¼š

```javascript
// æµ‹è¯• Supabase è¿æ¥
const { createClient } = require('@supabase/supabase-js')

const supabase = createClient(
  'https://your-project-id.supabase.co',
  'your-anon-key'
)

// æµ‹è¯•æŸ¥è¯¢
async function testConnection() {
  const { data, error } = await supabase
    .from('comments')
    .select('*')
    .limit(1)
  
  if (error) {
    console.error('è¿æ¥å¤±è´¥:', error)
  } else {
    console.log('è¿æ¥æˆåŠŸ:', data)
  }
}

testConnection()
```

## å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1: æ‰¾ä¸åˆ° API è®¾ç½®
**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®ä¿æ‚¨å·²ç»ç™»å½•åˆ°æ­£ç¡®çš„é¡¹ç›®
2. åœ¨å·¦ä¾§å¯¼èˆªæ ä¸­æŸ¥æ‰¾ "Settings"
3. å¦‚æœçœ‹ä¸åˆ° Settingsï¼Œå¯èƒ½éœ€è¦ç­‰å¾…é¡¹ç›®å®Œå…¨åˆ›å»ºå®Œæˆ

### é—®é¢˜ 2: API å¯†é’¥ä¸æ˜¾ç¤º
**è§£å†³æ–¹æ¡ˆï¼š**
1. åˆ·æ–°é¡µé¢
2. æ£€æŸ¥é¡¹ç›®çŠ¶æ€æ˜¯å¦æ­£å¸¸
3. è”ç³» Supabase æ”¯æŒ

### é—®é¢˜ 3: æ•°æ®åº“è¿æ¥å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ Project URL æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ anon public å¯†é’¥æ˜¯å¦æ­£ç¡®å¤åˆ¶
3. æ£€æŸ¥ç½‘ç»œè¿æ¥
4. ç¡®è®¤é¡¹ç›®åœ°åŒºè®¾ç½®

### é—®é¢˜ 4: è¡¨åˆ›å»ºå¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ‚¨æœ‰è¶³å¤Ÿçš„æƒé™
3. å°è¯•åˆ†æ­¥æ‰§è¡Œ SQL è¯­å¥

## å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. å¯†é’¥å®‰å…¨
- **anon public** å¯†é’¥å¯ä»¥å®‰å…¨åœ°åœ¨å‰ç«¯ä½¿ç”¨
- **service_role** å¯†é’¥åªèƒ½åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨
- ä¸è¦å°†å¯†é’¥æäº¤åˆ°å…¬å¼€çš„ä»£ç ä»“åº“

### 2. ç¯å¢ƒå˜é‡
- ä½¿ç”¨ `.env` æ–‡ä»¶å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- å°† `.env` æ·»åŠ åˆ° `.gitignore`
- åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡

### 3. æ•°æ®åº“å®‰å…¨
- å¯ç”¨è¡Œçº§å®‰å…¨ (RLS)
- åˆ›å»ºé€‚å½“çš„è®¿é—®ç­–ç•¥
- å®šæœŸå¤‡ä»½æ•°æ®

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š

1. **æµ‹è¯•è¯„è®ºç³»ç»Ÿ**ï¼šè®¿é—®æ¼”ç¤ºé¡µé¢æµ‹è¯•åŠŸèƒ½
2. **è‡ªå®šä¹‰æ ·å¼**ï¼šä¿®æ”¹è¯„è®ºç»„ä»¶çš„æ ·å¼
3. **æ·»åŠ åŠŸèƒ½**ï¼šå®ç°è¯„è®ºå®¡æ ¸ã€é‚®ä»¶é€šçŸ¥ç­‰
4. **éƒ¨ç½²ä¸Šçº¿**ï¼šå°†é¡¹ç›®éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ–‡æ¡£**ï¼š[Supabase å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs)
2. **ç¤¾åŒºæ”¯æŒ**ï¼š[Supabase Discord](https://discord.supabase.com)
3. **GitHub Issues**ï¼š[Supabase GitHub](https://github.com/supabase/supabase)

---

{{< callout type="success" emoji="âœ…" >}}
**æ­å–œï¼** ç°åœ¨æ‚¨å·²ç»æˆåŠŸé…ç½®äº† Supabase é¡¹ç›®ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨è¯„è®ºç³»ç»Ÿäº†ã€‚
{{< /callout >}}
